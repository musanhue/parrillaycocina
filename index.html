<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parrilla y Cocina | El Mejor Asado para tu Curso</title>
    <!-- Favicon de Asado -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçñ</text></svg>">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, setDoc, updateDoc, increment, onSnapshot, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // =================================================================================
        // ‚öôÔ∏è CONFIGURACI√ìN DE FIREBASE
        // =================================================================================
        const myFirebaseConfig = {
            apiKey: "AIzaSyBplqLjYHpyHK_sndx0GTkOP7LBGVoBIuw",
            authDomain: "parrillaycocina-72d50.firebaseapp.com",
            projectId: "parrillaycocina-72d50",
            storageBucket: "parrillaycocina-72d50.firebasestorage.app",
            messagingSenderId: "732351092429",
            appId: "1:732351092429:web:3a4ae873cf28be5b27bb84"
        };
        // =================================================================================

        
        // Datos por defecto (Se usan si la BD est√° vac√≠a)
        const defaultMenus = {
            menu1: {
                title: "Men√∫ 1",
                badge: "Econ√≥mico",
                image: "https://images.unsplash.com/photo-1598515214211-89d3c73ae83b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                sections: [
                    { title: "üåÑ Desayuno", items: ["‚Ä¢ Marraqueta jam√≥n/queso", "‚Ä¢ Leche, jugo, t√© y caf√©"] },
                    { title: "üî• Almuerzo Parrillero", items: ["‚Ä¢ Trutro entero de pollo üçó", "‚Ä¢ Chorip√°n con pebre y salsas", "‚Ä¢ Paleta de Helado üç¶"] },
                    { title: "üåá Once", items: ["‚Ä¢ Completo Italiano üå≠", "‚Ä¢ Bebida, t√© y caf√©"] }
                ]
            },
            menu2: {
                title: "Men√∫ 2",
                badge: "RECOMENDADO",
                image: "https://images.unsplash.com/photo-1600891964092-4316c288032e?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                sections: [
                    { title: "üåÑ Desayuno", items: ["‚Ä¢ Marraqueta jam√≥n/queso", "‚Ä¢ Leche, jugo, t√© y caf√©"] },
                    { title: "üî• Almuerzo Parrillero", items: ["‚Ä¢ Lomo de Res ü•©", "‚Ä¢ Chorip√°n con pebre y salsas", "‚Ä¢ Paleta de Helado üç¶"] },
                    { title: "üåá Once", items: ["‚Ä¢ Completo Italiano üå≠", "‚Ä¢ Bebida, t√© y caf√©"] }
                ]
            },
            menu3: {
                title: "Men√∫ 3",
                badge: "VIP",
                image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                sections: [
                    { title: "üåÑ Desayuno", items: ["‚Ä¢ Marraqueta jam√≥n/queso", "‚Ä¢ Leche, jugo, t√© y caf√©"] },
                    { title: "üî• Almuerzo Parrillero", items: ["‚Ä¢ Lomo de Res ü•©", "‚Ä¢ Chorip√°n con pebre y salsas", "‚Ä¢ Paleta de Helado üç¶"] },
                    { title: "üåá Once", items: ["‚Ä¢ Hamburguesa Queso üçî", "‚Ä¢ Bebida, t√© y caf√©"] }
                ]
            }
        };

        let db, auth;
        let currentMenus = JSON.parse(JSON.stringify(defaultMenus));
        let isOfflineMode = false;
        let hasLoggedFormView = false; // Para no contar scroll repetido en la misma sesi√≥n

        // Inicializaci√≥n
        async function initApp() {
            // Verificamos si el usuario puso sus credenciales
            if (myFirebaseConfig.apiKey === "TU_API_KEY_AQUI") {
                enableOfflineMode();
                return;
            }
            startFirebase(myFirebaseConfig);
        }

        async function startFirebase(config) {
            try {
                const app = initializeApp(config);
                db = getFirestore(app);
                auth = getAuth(app);

                // Autenticaci√≥n an√≥nima
                await signInAnonymously(auth);

                // Listener de Auth
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        console.log("Conectado a Firebase");
                        setupFirestoreListener();
                        // Registrar Visita (si no es admin)
                        if (window.location.hash !== '#admin') {
                            trackEvent('views');
                        }
                    } else {
                        enableOfflineMode();
                    }
                });
            } catch (e) {
                console.error("Error iniciando Firebase:", e);
                enableOfflineMode();
            }
        }

        function getMenusRef() {
            return doc(db, 'contenidos', 'menus_web');
        }
        
        function getStatsRef() {
            return doc(db, 'contenidos', 'stats_web');
        }

        // --- SISTEMA DE ANAL√çTICAS ---
        window.trackEvent = async function(metric) {
            if (isOfflineMode || window.location.hash === '#admin') return;
            try {
                const statsRef = getStatsRef();
                // Usamos update con increment para contar at√≥micamente
                await updateDoc(statsRef, {
                    [metric]: increment(1)
                }).catch(async (err) => {
                    // Si el documento no existe, lo creamos
                    if (err.code === 'not-found') {
                        await setDoc(statsRef, { views: 0, menu_clicks: 0, form_reached: 0, conversions: 0 });
                        await updateDoc(statsRef, { [metric]: increment(1) });
                    }
                });
            } catch (e) {
                console.error("Error tracking:", e);
            }
        };

        // Escuchar estad√≠sticas para el admin
        function setupStatsListener() {
            const statsRef = getStatsRef();
            onSnapshot(statsRef, (docSnap) => {
                if (docSnap.exists()) {
                    renderAdminStats(docSnap.data());
                }
            });
        }

        function setupFirestoreListener() {
            try {
                const menusRef = getMenusRef();
                onSnapshot(menusRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        currentMenus = data.menu1 ? data : defaultMenus;
                    } else {
                        setDoc(menusRef, defaultMenus);
                        currentMenus = defaultMenus;
                    }
                    renderPublicMenus();
                    if (!document.getElementById('admin-view').classList.contains('hidden')) {
                        renderAdminForms();
                        setupStatsListener(); // Iniciar listener de stats si es admin
                    }
                });
            } catch (e) {
                enableOfflineMode();
            }
        }

        function enableOfflineMode() {
            isOfflineMode = true;
            currentMenus = defaultMenus;
            renderPublicMenus();
            // Deshabilitar UI admin...
        }

        // Guardar cambios del men√∫
        window.saveMenuChanges = async function() {
            if (isOfflineMode) { alert("Modo Offline."); return; }
            const saveBtn = document.getElementById('save-btn');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Guardando...';
            saveBtn.disabled = true;

            try {
                const updatedMenus = {};
                const getVal = (id) => document.getElementById(id)?.value || "";
                ['menu1', 'menu2', 'menu3'].forEach(key => {
                    const originalImg = currentMenus[key] ? currentMenus[key].image : defaultMenus[key].image;
                    updatedMenus[key] = {
                        title: getVal(`${key}-title`) || defaultMenus[key].title,
                        badge: getVal(`${key}-badge`),
                        image: originalImg,
                        sections: [
                            { title: getVal(`${key}-s1-title`), items: getVal(`${key}-s1-items`).split('\n').filter(i => i.trim()) },
                            { title: getVal(`${key}-s2-title`), items: getVal(`${key}-s2-items`).split('\n').filter(i => i.trim()) },
                            { title: getVal(`${key}-s3-title`), items: getVal(`${key}-s3-items`).split('\n').filter(i => i.trim()) }
                        ]
                    };
                });
                await setDoc(getMenusRef(), updatedMenus);
                alert('¬°Cambios guardados exitosamente! ‚úÖ');
            } catch (e) {
                alert('Error al guardar: ' + e.message);
            } finally {
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        };

        // Renderizado Men√∫s P√∫blicos
        window.renderPublicMenus = function() {
            const container = document.getElementById('public-menus-container');
            if (!container) return;
            let html = '';
            const renderItems = (items) => (items || []).map(i => `<li>${i}</li>`).join('');

            ['menu1', 'menu2', 'menu3'].forEach(key => {
                const menu = currentMenus[key] || defaultMenus[key];
                let borderClass = key === 'menu2' ? 'border-4 border-brand-yellow relative' : '';
                let badgeHtml = key === 'menu2' ? `<div class="absolute top-0 right-0 bg-brand-yellow text-brand-dark text-xs font-bold px-3 py-1 rounded-bl-lg z-10">${menu.badge || ''}</div>` : 
                               (menu.badge ? `<div class="absolute top-0 left-0 bg-brand-red text-white text-xs font-bold px-3 py-1 rounded-br-lg">${menu.badge}</div>` : '');
                html += `
                <div class="bg-white text-gray-800 rounded-xl overflow-hidden shadow-2xl transform hover:-translate-y-2 transition duration-300 flex flex-col h-full ${borderClass}">
                    ${badgeHtml}
                    <div class="h-48 overflow-hidden relative">
                        <img src="${menu.image}" alt="${menu.title}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/800x600?text=Menu'">
                    </div>
                    <div class="p-6 flex-grow flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-2xl font-bold text-brand-red">${menu.title}</h3>
                        </div>
                        <div class="flex-grow space-y-4">
                            ${menu.sections.map((section, index) => `
                                <div class="${index > 0 ? 'border-t pt-2' : ''}">
                                    <h4 class="font-bold text-sm text-gray-500 uppercase mb-1">${section.title}</h4>
                                    <ul class="text-sm space-y-1 ml-2">
                                        ${renderItems(section.items)}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="selectMenu('${menu.title}')" class="mt-6 w-full block ${key === 'menu2' ? 'bg-brand-yellow text-brand-dark hover:bg-yellow-400' : 'bg-gray-900 text-white hover:bg-brand-red'} text-center py-3 rounded-lg font-bold transition">Cotizar Este Men√∫</button>
                    </div>
                </div>`;
            });
            container.innerHTML = html;
            updateFormSelect();
        };

        // Renderizado Admin Forms
        window.renderAdminForms = function() {
            const container = document.getElementById('admin-forms-container');
            if (!container) return;
            let html = '';
            ['menu1', 'menu2', 'menu3'].forEach(key => {
                const menu = currentMenus[key] || defaultMenus[key];
                html += `
                <div class="bg-white p-6 rounded-lg shadow-md mb-8 border-l-4 border-brand-red">
                    <h3 class="text-xl font-bold mb-4 text-brand-dark uppercase border-b pb-2">Editando: ${key}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div><label class="block text-xs font-bold text-gray-500 uppercase">T√≠tulo</label><input type="text" id="${key}-title" value="${menu.title}" class="w-full border p-2 rounded"></div>
                        <div><label class="block text-xs font-bold text-gray-500 uppercase">Etiqueta</label><input type="text" id="${key}-badge" value="${menu.badge || ''}" class="w-full border p-2 rounded"></div>
                    </div>
                    <div class="space-y-4">
                        ${menu.sections.map((section, idx) => `
                            <div class="bg-gray-50 p-3 rounded">
                                <label class="block text-xs font-bold text-brand-red mb-1">Secci√≥n ${idx + 1}: T√≠tulo</label>
                                <input type="text" id="${key}-s${idx+1}-title" value="${section.title}" class="w-full border p-2 rounded mb-2">
                                <label class="block text-xs font-bold text-gray-500 mb-1">√çtems (uno por l√≠nea)</label>
                                <textarea id="${key}-s${idx+1}-items" class="w-full border p-2 rounded h-24 font-mono text-sm">${(section.items || []).join('\n')}</textarea>
                            </div>
                        `).join('')}
                    </div>
                </div>`;
            });
            container.innerHTML = html;
        }

        // Renderizado Stats Admin
        window.renderAdminStats = function(stats) {
            document.getElementById('stat-views').innerText = stats.views || 0;
            document.getElementById('stat-clicks').innerText = stats.menu_clicks || 0;
            document.getElementById('stat-forms').innerText = stats.form_reached || 0;
            document.getElementById('stat-conversions').innerText = stats.conversions || 0;
        }

        function updateFormSelect() {
            const select = document.getElementById('form-menu');
            if (!select) return;
            const currentVal = select.value;
            let optionsHtml = '';
            ['menu1', 'menu2', 'menu3'].forEach(key => {
                const menu = currentMenus[key] || defaultMenus[key];
                optionsHtml += `<option value="${menu.title}">${menu.title}</option>`;
            });
            optionsHtml += `<option value="Personalizado">Otro / Personalizado ‚ú®</option>`;
            select.innerHTML = optionsHtml;
            if (currentVal) select.value = currentVal;
        }

        // Setup Intersection Observer para trackear formulario
        window.setupFormObserver = function() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && !hasLoggedFormView) {
                        trackEvent('form_reached');
                        hasLoggedFormView = true;
                    }
                });
            }, { threshold: 0.5 });
            
            const contactSection = document.getElementById('contacto');
            if (contactSection) observer.observe(contactSection);
        }

        initApp();
        // Inicializar observador al cargar
        window.addEventListener('load', setupFormObserver);

    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-red': '#E63946',
                        'brand-dark': '#1D3557',
                        'brand-orange': '#F4A261',
                        'brand-yellow': '#E9C46A',
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .scroll-smooth { scroll-behavior: smooth; }
        .insta-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
        }
        .hero-bg {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1555939594-58d7cb561ad1?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="font-sans text-gray-800 scroll-smooth bg-gray-50">

    <!-- VISTA P√öBLICA -->
    <div id="public-view">
        <!-- Navbar -->
        <nav class="bg-white shadow-md fixed w-full z-50">
            <div class="container mx-auto px-6 py-3 flex justify-between items-center">
                <a href="#" class="text-2xl font-bold text-brand-red flex items-center gap-2">
                    üî• Parrilla y Cocina
                </a>
                
                <div class="md:hidden">
                    <button onclick="toggleMenu()" class="text-gray-600 hover:text-brand-red focus:outline-none">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>

                <div class="hidden md:flex items-center space-x-8">
                    <a href="#inicio" class="text-gray-700 hover:text-brand-red font-medium transition">Inicio</a>
                    <a href="#servicios" class="text-gray-700 hover:text-brand-red font-medium transition">Servicios</a>
                    <a href="#menu" class="text-gray-700 hover:text-brand-red font-medium transition">Men√∫</a>
                    <a href="#galeria" class="text-gray-700 hover:text-brand-red font-medium transition">Instagram</a>
                    <a href="#contacto" class="bg-brand-red text-white px-5 py-2 rounded-full font-bold hover:bg-red-700 transition shadow-lg transform hover:scale-105 flex items-center gap-2">
                        <i class="fas fa-hand-holding-dollar"></i> Cotizar Ahora
                    </a>
                </div>
            </div>
            
            <div id="mobile-menu" class="hidden md:hidden bg-white border-t p-4">
                <a href="#inicio" class="block py-2 text-gray-700 hover:text-brand-red" onclick="toggleMenu()">Inicio</a>
                <a href="#servicios" class="block py-2 text-gray-700 hover:text-brand-red" onclick="toggleMenu()">Servicios</a>
                <a href="#menu" class="block py-2 text-gray-700 hover:text-brand-red" onclick="toggleMenu()">Men√∫</a>
                <a href="#galeria" class="block py-2 text-gray-700 hover:text-brand-red" onclick="toggleMenu()">Galer√≠a</a>
                <a href="#contacto" class="block py-2 text-brand-red font-bold" onclick="toggleMenu()">Cotizar</a>
            </div>
        </nav>

        <!-- Hero Section -->
        <header id="inicio" class="hero-bg h-screen flex items-center justify-center text-center px-4 pt-16">
            <div class="max-w-4xl mx-auto text-white">
                <div class="inline-block bg-brand-orange text-white px-4 py-1 rounded-full text-sm font-bold mb-4 shadow-md animate-bounce">
                    üéì ¬°Temporada de Paseos 2026-2027!
                </div>
                <h1 class="text-4xl md:text-6xl font-bold mb-6 leading-tight">
                    El Mejor Asado para tu <span class="text-brand-yellow">Paseo de Curso</span> üçñüî•
                </h1>
                <p class="text-xl md:text-2xl mb-8 font-light">
                    Rel√°jate y disfruta. Nosotros ponemos la parrilla, la carne y la buena onda. ¬°Servicio completo para colegios!
                </p>
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <a href="#contacto" class="bg-brand-red hover:bg-red-700 text-white px-8 py-4 rounded-full text-lg font-bold transition transform hover:-translate-y-1 shadow-xl">
                        Solicitar Presupuesto üöå
                    </a>
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="bg-white hover:bg-gray-100 text-gray-900 px-8 py-4 rounded-full text-lg font-bold transition flex items-center justify-center gap-2">
                        <i class="fab fa-instagram text-pink-600 text-xl"></i> Ver Fotos
                    </a>
                </div>
            </div>
        </header>

        <!-- Por Qu√© Elegirnos -->
        <section id="servicios" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold text-brand-dark mb-4">¬øPor qu√© elegir Parrilla y Cocina? ü§î</h2>
                    <div class="w-24 h-1 bg-brand-red mx-auto rounded"></div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                    <div class="bg-gray-50 p-8 rounded-2xl shadow-lg hover:shadow-xl transition text-center border-b-4 border-brand-red">
                        <div class="bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-3xl">üë®‚Äçüç≥</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-brand-dark">Expertos Parrilleros</h3>
                        <p class="text-gray-600">Nuestro equipo sabe exactamente el punto de la carne. ¬°Nadie se queda con hambre y todo sale a tiempo!</p>
                    </div>
                    <div class="bg-gray-50 p-8 rounded-2xl shadow-lg hover:shadow-xl transition text-center border-b-4 border-brand-orange">
                        <div class="bg-orange-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-3xl">ü•ó</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-brand-dark">Opciones para Todos</h3>
                        <p class="text-gray-600">¬øVegetarianos? ¬øVeganos? ¬°Sin problema! Tenemos men√∫s inclusivos para que todo el curso disfrute.</p>
                    </div>
                    <div class="bg-gray-50 p-8 rounded-2xl shadow-lg hover:shadow-xl transition text-center border-b-4 border-brand-yellow">
                        <div class="bg-yellow-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span class="text-3xl">‚ö°</span>
                        </div>
                        <h3 class="text-xl font-bold mb-3 text-brand-dark">Servicio Full</h3>
                        <p class="text-gray-600">Llevamos todo: parrillas, carb√≥n, platos, cubiertos y salsas. Ustedes solo traigan las ganas de pasarlo bien.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Men√∫ Section (DYNAMIC) -->
        <section id="menu" class="py-20 bg-brand-dark text-white relative overflow-hidden">
            <div class="absolute top-0 right-0 -mr-20 -mt-20 w-64 h-64 bg-brand-red rounded-full opacity-20 blur-3xl"></div>
            <div class="absolute bottom-0 left-0 -ml-20 -mb-20 w-64 h-64 bg-brand-yellow rounded-full opacity-20 blur-3xl"></div>

            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-16">
                    <span class="text-brand-yellow font-bold tracking-wider uppercase text-sm">Nuestros Packs Escolares</span>
                    <h2 class="text-3xl md:text-5xl font-bold mt-2">¬°Desayuno, Almuerzo y Once! üòã</h2>
                    <p class="mt-4 text-gray-300">Incluye servicio completo por todo el d√≠a</p>
                </div>

                <!-- CONTENEDOR DE MEN√öS DIN√ÅMICOS -->
                <div id="public-menus-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Loading State -->
                    <div class="col-span-3 text-center py-10">
                        <i class="fas fa-spinner fa-spin text-4xl text-brand-yellow"></i>
                        <p class="mt-4">Cargando men√∫s actualizados...</p>
                    </div>
                </div>
                
                <div class="mt-8 text-center bg-white/10 p-4 rounded-lg backdrop-blur-sm">
                    <p class="text-sm italic">Nota: El almuerzo base no incluye ensaladas ni bebestibles, pero puedes consultar por nuestro men√∫ complementario.</p>
                </div>
            </div>
        </section>

        <!-- Instagram Simulated Section -->
        <section id="galeria" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <i class="fab fa-instagram text-5xl bg-clip-text text-transparent bg-gradient-to-r from-purple-500 to-pink-500 mb-4"></i>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800">S√≠guenos en Instagram</h2>
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="text-brand-red font-semibold hover:underline text-lg">@parrilla_y_cocina_</a>
                    <p class="text-gray-500 mt-2">¬°Mira c√≥mo lo han pasado otros cursos! üì∏</p>
                </div>
                <!-- Fake Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="group relative block overflow-hidden rounded-lg aspect-square">
                        <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Parrilla llena" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 insta-overlay opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center text-white space-x-4">
                            <span><i class="fas fa-heart"></i> 124</span>
                            <span><i class="fas fa-comment"></i> 12</span>
                        </div>
                    </a>
                    <a href="https://www.instagram.com/p/DE_RDIhN5MN/?img_index=1" target="_blank" class="group relative block overflow-hidden rounded-lg aspect-square">
                        <img src="https://images.unsplash.com/photo-1529692236671-f1f6cf9683ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Carne a la parrilla lista" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 insta-overlay opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center text-white space-x-4">
                            <span><i class="fas fa-heart"></i> 156</span>
                            <span><i class="fas fa-comment"></i> 8</span>
                        </div>
                    </a>
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="group relative block overflow-hidden rounded-lg aspect-square">
                        <img src="https://images.unsplash.com/photo-1528605248644-14dd04022da1?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Amigos comiendo" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 insta-overlay opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center text-white space-x-4">
                            <span><i class="fas fa-heart"></i> 256</span>
                            <span><i class="fas fa-comment"></i> 34</span>
                        </div>
                    </a>
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="group relative block overflow-hidden rounded-lg aspect-square">
                        <img src="https://images.unsplash.com/photo-1594041680534-e8c8cdebd659?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Fuego asado" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 insta-overlay opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center text-white space-x-4">
                            <span><i class="fas fa-heart"></i> 140</span>
                            <span><i class="fas fa-comment"></i> 18</span>
                        </div>
                    </a>
                </div>
                <div class="text-center mt-8">
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="inline-block border-2 border-pink-500 text-pink-600 font-bold px-8 py-3 rounded-full hover:bg-pink-50 transition">
                        Ver m√°s en Instagram <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </div>
        </section>

        <!-- Contacto Section -->
        <section id="contacto" class="py-20 bg-white">
            <div class="container mx-auto px-6 max-w-4xl">
                <div class="bg-brand-dark text-white rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row">
                    <div class="p-10 md:w-1/2 bg-brand-red flex flex-col justify-center">
                        <h2 class="text-3xl font-bold mb-4">¬øListos para el mejor paseo? üöå</h2>
                        <p class="mb-8 text-red-100">D√©janos tus datos y te enviaremos una cotizaci√≥n personalizada para tu curso.</p>
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <i class="fab fa-whatsapp text-2xl w-10"></i>
                                <span class="font-medium">+56 9 6708 3372</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-envelope text-2xl w-10"></i>
                                <span class="font-medium">contacto@parrillaycocina.cl</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-map-marker-alt text-2xl w-10"></i>
                                <span class="font-medium">Santiago y alrededores</span>
                            </div>
                        </div>
                    </div>
                    <div class="p-10 md:w-1/2 bg-white text-gray-800">
                        <form onsubmit="sendToWhatsapp(event)">
                            <div class="mb-4">
                                <label class="block text-sm font-bold mb-2">Nombre del Apoderado/Encargado</label>
                                <input type="text" id="form-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-brand-red" placeholder="Ej: Mar√≠a P√©rez" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-bold mb-2">Curso / Colegio / Empresa</label>
                                <input type="text" id="form-course" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-brand-red" placeholder="Ej: 4to Medio A o Empresa SA" required>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-bold mb-2">Selecciona tu Men√∫</label>
                                <select id="form-menu" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-brand-red bg-white cursor-pointer">
                                    <!-- Options filled by JS -->
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-bold mb-2">Cantidad de Personas (Aprox)</label>
                                <input type="number" id="form-quantity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-brand-red" placeholder="Ej: 40" required>
                            </div>
                            <button type="submit" class="w-full bg-brand-dark text-white font-bold py-3 rounded-lg hover:bg-gray-800 transition transform hover:scale-105">
                                <i class="fab fa-whatsapp mr-2"></i> Enviar a WhatsApp üöÄ
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-gray-900 text-white py-8">
            <div class="container mx-auto px-6 text-center">
                <p class="text-2xl font-bold mb-4 text-brand-red">üî• Parrilla y Cocina</p>
                <div class="flex justify-center space-x-6 mb-6">
                    <a href="https://www.instagram.com/parrilla_y_cocina_/" target="_blank" class="hover:text-brand-orange transition text-2xl" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.facebook.com/share/1DBr8XZ5L7/?mibextid=wwXIfr" target="_blank" class="hover:text-brand-orange transition text-2xl" title="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="https://www.tiktok.com/@parrilla.cocina?_r=1&_t=ZS-93UZinzVQxT" target="_blank" class="hover:text-brand-orange transition text-2xl" title="TikTok"><i class="fab fa-tiktok"></i></a>
                    <a href="https://wa.me/56967083372" target="_blank" class="hover:text-brand-orange transition text-2xl" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                </div>
                <div class="flex justify-center items-center gap-4 text-gray-500 text-sm">
                    <p>¬© 2024 Parrilla y Cocina. Todos los derechos reservados.</p>
                    <a href="#admin" onclick="checkHash()" class="hover:text-white" title="Acceso Admin"><i class="fas fa-lock"></i></a>
                </div>
            </div>
        </footer>

        <!-- WhatsApp Floating -->
        <a href="https://wa.me/56967083372" target="_blank" class="fixed bottom-6 right-6 bg-green-500 text-white p-4 rounded-full shadow-lg hover:bg-green-600 transition z-50 animate-bounce">
            <i class="fab fa-whatsapp text-3xl"></i>
        </a>
    </div>

    <!-- VISTA LOGIN -->
    <div id="login-view" class="hidden fixed inset-0 z-50 bg-brand-dark flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-md w-full text-center">
            <div class="mb-6">
                <i class="fas fa-user-shield text-5xl text-brand-red"></i>
            </div>
            <h2 class="text-2xl font-bold mb-6 text-gray-800">Acceso Administrativo</h2>
            <form onsubmit="handleLogin(event)">
                <input type="text" id="username" placeholder="Usuario" class="w-full mb-4 p-3 border rounded focus:border-brand-red outline-none">
                <input type="password" id="password" placeholder="Contrase√±a" class="w-full mb-6 p-3 border rounded focus:border-brand-red outline-none">
                <button type="submit" class="w-full bg-brand-red text-white font-bold py-3 rounded hover:bg-red-700 transition">Entrar al Panel</button>
            </form>
            <button onclick="window.location.hash=''" class="mt-4 text-gray-500 hover:text-gray-800 text-sm">Volver al sitio</button>
        </div>
    </div>

    <!-- VISTA ADMIN PANEL -->
    <div id="admin-view" class="hidden min-h-screen bg-gray-100 pb-20">
        <!-- Admin Navbar -->
        <div class="bg-brand-dark text-white p-4 shadow-md sticky top-0 z-40">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="font-bold text-xl"><i class="fas fa-tools mr-2"></i> Editor de Men√∫s</h1>
                <div class="flex gap-4">
                    <a href="#" class="text-gray-300 hover:text-white flex items-center gap-2 bg-gray-700 px-3 py-1 rounded text-sm"><i class="fas fa-eye"></i> Ver P√°gina</a>
                    <button onclick="logout()" class="text-red-300 hover:text-white text-sm"><i class="fas fa-sign-out-alt"></i> Salir</button>
                </div>
            </div>
        </div>

        <!-- STATS DASHBOARD -->
        <div class="bg-white border-b shadow-sm mb-6">
            <div class="container mx-auto px-4 py-6">
                <h2 class="text-lg font-bold text-gray-600 mb-4 uppercase tracking-wider">M√©tricas en Tiempo Real üìä</h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <!-- Visitas -->
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 shadow-sm text-center">
                        <div class="text-blue-500 text-2xl mb-1"><i class="fas fa-eye"></i></div>
                        <div class="text-3xl font-bold text-blue-900" id="stat-views">0</div>
                        <div class="text-xs text-blue-600 font-bold uppercase mt-1">Visitas Totales</div>
                    </div>
                    <!-- Menu Clicks -->
                    <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-100 shadow-sm text-center">
                        <div class="text-yellow-500 text-2xl mb-1"><i class="fas fa-mouse-pointer"></i></div>
                        <div class="text-3xl font-bold text-yellow-900" id="stat-clicks">0</div>
                        <div class="text-xs text-yellow-600 font-bold uppercase mt-1">Inter√©s en Men√∫</div>
                    </div>
                    <!-- Form Reached -->
                    <div class="bg-purple-50 p-4 rounded-xl border border-purple-100 shadow-sm text-center">
                        <div class="text-purple-500 text-2xl mb-1"><i class="fas fa-file-alt"></i></div>
                        <div class="text-3xl font-bold text-purple-900" id="stat-forms">0</div>
                        <div class="text-xs text-purple-600 font-bold uppercase mt-1">Vieron Formulario</div>
                    </div>
                    <!-- Conversions -->
                    <div class="bg-green-50 p-4 rounded-xl border border-green-100 shadow-sm text-center">
                        <div class="text-green-500 text-2xl mb-1"><i class="fab fa-whatsapp"></i></div>
                        <div class="text-3xl font-bold text-green-900" id="stat-conversions">0</div>
                        <div class="text-xs text-green-600 font-bold uppercase mt-1">Cotizaciones</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mx-auto px-4 py-8 max-w-4xl">
            <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6" role="alert">
                <p class="font-bold">Modo Edici√≥n</p>
                <p>Cualquier cambio que guardes aqu√≠ se reflejar√° inmediatamente en la p√°gina principal para todos los usuarios.</p>
            </div>

            <div id="admin-forms-container">
                <!-- Se rellena con JS -->
                <div class="text-center py-10"><i class="fas fa-spinner fa-spin text-4xl"></i></div>
            </div>

            <!-- Bot√≥n flotante para guardar -->
            <div class="fixed bottom-6 right-6 flex gap-4">
                 <button onclick="window.scrollTo(0,0)" class="bg-gray-500 text-white p-4 rounded-full shadow-lg hover:bg-gray-600">
                    <i class="fas fa-arrow-up"></i>
                </button>
                <button id="save-btn" onclick="saveMenuChanges()" class="bg-green-600 text-white px-8 py-4 rounded-full shadow-xl hover:bg-green-700 font-bold flex items-center gap-2 transform hover:scale-105 transition">
                    <i class="fas fa-save"></i> Guardar Cambios
                </button>
            </div>
        </div>
    </div>

    <script>
        // L√≥gica de Vistas (Router simple)
        function checkHash() {
            const hash = window.location.hash;
            const publicView = document.getElementById('public-view');
            const loginView = document.getElementById('login-view');
            const adminView = document.getElementById('admin-view');

            publicView.classList.add('hidden');
            loginView.classList.add('hidden');
            adminView.classList.add('hidden');

            if (hash === '#admin') {
                if (localStorage.getItem('isAdmin') === 'true') {
                    adminView.classList.remove('hidden');
                    window.renderAdminForms(); // Cargar formularios al entrar
                    // Forzamos actualizaci√≥n de listeners si ya estamos conectados
                    if (window.setupStatsListener) window.setupStatsListener();
                } else {
                    loginView.classList.remove('hidden');
                }
            } else {
                publicView.classList.remove('hidden');
            }
        }

        // Auth L√≥gica
        function handleLogin(e) {
            e.preventDefault();
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;

            if (u === 'cristian' && p === 'felipecata') {
                localStorage.setItem('isAdmin', 'true');
                window.location.reload(); // Recargar para aplicar vista
            } else {
                alert('Credenciales incorrectas');
            }
        }

        function logout() {
            localStorage.removeItem('isAdmin');
            window.location.hash = '';
        }

        // Navbar Toggle
        function toggleMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function selectMenu(menuName) {
            window.trackEvent('menu_clicks'); // Registrar click
            const select = document.getElementById('form-menu');
            if(select) {
                select.value = menuName;
                document.getElementById('contacto').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // WhatsApp
        function sendToWhatsapp(event) {
            event.preventDefault();
            window.trackEvent('conversions'); // Registrar conversi√≥n
            const name = document.getElementById('form-name').value;
            const course = document.getElementById('form-course').value;
            const menu = document.getElementById('form-menu').value;
            const quantity = document.getElementById('form-quantity').value;
            const message = `Hola! üëã Me gustar√≠a cotizar un asado.%0A%0Aüë§ *Nombre:* ${name}%0Aüè¢ *Curso/Empresa:* ${course}%0Aüçñ *Men√∫:* ${menu}%0Aüë• *Cantidad:* ${quantity} personas%0A%0AQuedo atento a su respuesta!`;
            window.open(`https://wa.me/56967083372?text=${message}`, '_blank');
        }

        // Listener de cambios de URL
        window.addEventListener('hashchange', checkHash);
        window.addEventListener('load', checkHash);
    </script>
</body>
</html>
